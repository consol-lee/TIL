# 2023-03-09

CiliumÏùò Hubble ÏÑ§Ïπò Ïãú gRPC ÌÜµÏã†Ïù¥ ÏïàÎêúÎã§Í≥† ÏïàÎê®
Îã§Ïãú ÏÑ§Ïπò ÏßÑÌñâ

- kubernetes 1.22 ÌôòÍ≤Ω ÏõåÏª§ÎÖ∏Îìú 3ÎåÄ
- cilium 1.10 Î≤ÑÏ†Ñ

Í¥ÄÎ†® URL
- https://docs.cilium.io/en/v1.10/gettingstarted/hubble_setup/


(1) cilium ÏúºÎ°ú ÏÑ§ÏπòÌïòÍ∏∞ -> helm ÏúºÎ°ú ÏÑ§ÏπòÌïúÍ≤å ÏïÑÎãàÏñ¥ÏÑú secret ÏóêÎü¨ÎÇ® „Ö†„Ö†
- Í¥ÄÎ†® Ïù¥Ïäà : https://github.com/cilium/cilium-cli/issues/959
```
$ cilium hubble enable
‚ö†Ô∏è  Error parsing helm cli secret: unable to retrieve helm values secret kube-system/cilium-cli-helm-values: secrets "cilium-cli-helm-values" not found
‚ö†Ô∏è  Proceeding in unknown installation state
üîÆ Auto-detected cilium version v1.10.16
üîë Created CA in secret cilium-ca
‚ÑπÔ∏è  helm template --namespace kube-system cilium cilium/cilium --version 1.10.16 --set hubble.enabled=true,hubble.relay.enabled=true,hubble.tls.ca.cert=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNGRENDQWJxZ0F3SUJBZ0lVQlhoYWlsd3VIWkNCOTYvSDNzbk5EMS9IWHZJd0NnWUlLb1pJemowRUF3SXcKYURFTE1Ba0dBMVVFQmhNQ1ZWTXhGakFVQmdOVkJBZ1REVk5oYmlCR2NtRnVZMmx6WTI4eEN6QUpCZ05WQkFjVApBa05CTVE4d0RRWURWUVFLRXdaRGFXeHBkVzB4RHpBTkJnTlZCQXNUQmtOcGJHbDFiVEVTTUJBR0ExVUVBeE1KClEybHNhWFZ0SUVOQk1CNFhEVEl6TURNd09UQXlNalF3TUZvWERUSTRNRE13TnpBeU1qUXdNRm93YURFTE1Ba0cKQTFVRUJoTUNWVk14RmpBVUJnTlZCQWdURFZOaGJpQkdjbUZ1WTJselkyOHhDekFKQmdOVkJBY1RBa05CTVE4dwpEUVlEVlFRS0V3WkRhV3hwZFcweER6QU5CZ05WQkFzVEJrTnBiR2wxYlRFU01CQUdBMVVFQXhNSlEybHNhWFZ0CklFTkJNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUVNVk5XbGtXaTNQMGRQR2NXbElLejF3SEcKOXB2TjN4Z0hEZXFuRFhDWnNCdGJodzJmalZHZk5mY1EvRVk4bzdoMStOQmJXTGc1a21xQ0N6MGoyN3dNS3FOQwpNRUF3RGdZRFZSMFBBUUgvQkFRREFnRUdNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdIUVlEVlIwT0JCWUVGQlZ2Cmo5OE9nNlU2MkRHNFBkS0FzcUhDWWlOVE1Bb0dDQ3FHU000OUJBTUNBMGdBTUVVQ0lRQ3czc1dJQXNFMSt4RlcKTThHeUp3SnpJeFRHRmpTSDhSL3kxa2VITmd1eVd3SWdEY0ZmenRaZU1kRGRTOTB6MGp3ajFyVXBZRzNGNThiOQpUM0VFdVZXMVIyTT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=,hubble.tls.ca.key=[--- REDACTED WHEN PRINTING TO TERMINAL (USE --redact-helm-certificate-keys=false TO PRINT) ---]
‚ú® Patching ConfigMap cilium-config to enable Hubble...
üöÄ Creating ConfigMap for Cilium version 1.10.16...
‚ôªÔ∏è  Restarted Cilium pods
‚åõ Waiting for Cilium to become ready before deploying other Hubble component(s)...
```

(Î≤àÏô∏) ÏùºÎã® hubble ÏÑ§Ïπò
```
$ export HUBBLE_VERSION=$(curl -s https://raw.githubusercontent.com/cilium/hubble/master/stable.txt)
$ curl -L --remote-name-all https://github.com/cilium/hubble/releases/download/$HUBBLE_VERSION/hubble-linux-amd64.tar.gz{,.sha256sum}
$ sha256sum --check hubble-linux-amd64.tar.gz.sha256sum
$ sudo tar xzvfC hubble-linux-amd64.tar.gz /usr/local/bin
$ rm hubble-linux-amd64.tar.gz{,.sha256sum}
```